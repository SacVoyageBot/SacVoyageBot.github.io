<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ —ç–∫—Å–∫—É—Ä—Å–∏–∏</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #ffffff;
            color: #000000;
            padding: 20px;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã */
        .home-container {
            max-width: 400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 24px;
            margin-bottom: 10px;
            color: #333;
        }

        .header p {
            color: #666;
            font-size: 16px;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .tour-block {
            aspect-ratio: 1; /* –î–µ–ª–∞–µ–º –∫–≤–∞–¥—Ä–∞—Ç */
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            text-decoration: none;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            padding: 15px;
            text-align: center;
            cursor: pointer;
        }

        .tour-block:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        .tour-icon {
            font-size: 24px;
            margin-bottom: 8px;
        }

        .tour-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .tour-duration {
            font-size: 12px;
            opacity: 0.9;
        }

        /* –†–∞–∑–Ω—ã–µ —Ü–≤–µ—Ç–∞ –¥–ª—è –±–ª–æ–∫–æ–≤ */
        .tour-block:nth-child(1) { background: linear-gradient(135deg, #FF6B6B, #FF8E8E); }
        .tour-block:nth-child(2) { background: linear-gradient(135deg, #4ECDC4, #88D3CE); }
        .tour-block:nth-child(3) { background: linear-gradient(135deg, #45B7D1, #7BC8E0); }
        .tour-block:nth-child(4) { background: linear-gradient(135deg, #96CEB4, #B8E0C8); }
        .tour-block:nth-child(5) { background: linear-gradient(135deg, #FFEAA7, #FFEFBD); color: #333; }
        .tour-block:nth-child(6) { background: linear-gradient(135deg, #DDA0DD, #E6B8E6); }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã —ç–∫—Å–∫—É—Ä—Å–∏–∏ (–∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç–∞) */
        .tour-page {
            display: none;
        }

        .app-container {
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        .visual-container {
            flex: 0 0 60vh;
            position: relative;
            background: #000;
            overflow: hidden;
        }

        #mainImage {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .image-caption {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0,0,0,0.8));
            color: white;
            padding: 20px 15px 10px;
            font-size: 14px;
            text-align: center;
        }

        .nav-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255,255,255,0.8);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 20px;
            cursor: pointer;
        }

        .prev-btn {
            left: 10px;
        }

        .next-btn {
            right: 10px;
        }

        .back-btn {
            position: absolute;
            top: 15px;
            left: 15px;
            background: rgba(255,255,255,0.9);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 18px;
            cursor: pointer;
            z-index: 10;
        }

        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–∏–∞–ª–æ–≥–∞ */
        .dialogue-container {
            flex: 1;
            display: flex;
            background: #f8f8f8;
            border-top: 1px solid #e0e0e0;
        }

        /* –°–µ–∫—Ü–∏—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ */
        .character-section {
            flex: 0 0 100px;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px 10px;
            background: #f0f0f0;
        }

        .character {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid #50a8eb;
        }

        .character-name {
            margin-top: 8px;
            font-size: 12px;
            text-align: center;
            font-weight: 500;
        }

        /* –°–µ–∫—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ */
        .text-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 15px;
        }

        .text-content {
            flex: 1;
            font-size: 16px;
            line-height: 1.5;
            margin-bottom: 15px;
            overflow-y: auto;
            padding: 10px;
            background: #ffffff;
            border-radius: 10px;
            border: 1px solid #e0e0e0;
        }

        .controls {
            display: flex;
            gap: 8px;
            margin-bottom: 10px;
        }

        .controls button {
            flex: 1;
            padding: 10px 5px;
            border: none;
            border-radius: 8px;
            background: #50a8eb;
            color: #ffffff;
            cursor: pointer;
            font-size: 12px;
        }

        .progress-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .progress-bar {
            flex: 1;
            height: 6px;
            background: #e0e0e0;
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: #50a8eb;
            width: 10%;
            transition: width 0.3s ease;
        }

        .progress-text {
            font-size: 12px;
            color: #999999;
            min-width: 40px;
        }

        /* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ */
        .loading {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            color: white;
            display: none;
            justify-content: center;
            align-items: center;
            font-size: 18px;
            z-index: 1000;
        }

        .loading.show {
            display: flex;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 480px) {
            .grid-container {
                gap: 10px;
            }
            
            .tour-block {
                padding: 10px;
            }
            
            .tour-title {
                font-size: 13px;
            }
        }
    </style>
</head>
<body>
    <!-- –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ -->
    <div id="homePage" class="home-container">
        <div class="header">
            <h1>üöÄ –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ —ç–∫—Å–∫—É—Ä—Å–∏–∏</h1>
            <p>–í—ã–±–µ—Ä–∏—Ç–µ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â—É—é –≤–∞—Å —ç–∫—Å–∫—É—Ä—Å–∏—é</p>
        </div>

        <div class="grid-container">
            <!-- –ë–ª–æ–∫–∏ —ç–∫—Å–∫—É—Ä—Å–∏–π -->
            <div class="tour-block" onclick="openTour('history')">
                <div class="tour-icon">üèõÔ∏è</div>
                <div class="tour-title">–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π —Ü–µ–Ω—Ç—Ä</div>
                <div class="tour-duration">45 –º–∏–Ω</div>
            </div>

            <div class="tour-block" onclick="openTour('architecture')">
                <div class="tour-icon">üè∞</div>
                <div class="tour-title">–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞</div>
                <div class="tour-duration">60 –º–∏–Ω</div>
            </div>

            <div class="tour-block" onclick="openTour('museums')">
                <div class="tour-icon">üñºÔ∏è</div>
                <div class="tour-title">–ú—É–∑–µ–∏ –≥–æ—Ä–æ–¥–∞</div>
                <div class="tour-duration">90 –º–∏–Ω</div>
            </div>

            <div class="tour-block" onclick="openTour('parks')">
                <div class="tour-icon">üå≥</div>
                <div class="tour-title">–ü–∞—Ä–∫–∏ –∏ —Å–∞–¥—ã</div>
                <div class="tour-duration">30 –º–∏–Ω</div>
            </div>

            <div class="tour-block" onclick="openTour('modern')">
                <div class="tour-icon">üè¢</div>
                <div class="tour-title">–°–æ–≤—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç—å</div>
                <div class="tour-duration">40 –º–∏–Ω</div>
            </div>

            <div class="tour-block" onclick="openTour('secret')">
                <div class="tour-icon">üîç</div>
                <div class="tour-title">–°–µ–∫—Ä–µ—Ç–Ω—ã–µ –º–µ—Å—Ç–∞</div>
                <div class="tour-duration">75 –º–∏–Ω</div>
            </div>
        </div>
    </div>

    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ —ç–∫—Å–∫—É—Ä—Å–∏–∏ (–∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç–∞) -->
    <div id="tourPage" class="tour-page">
        <div class="app-container">
            <div class="visual-container">
                <button class="back-btn" onclick="goBackToHome()">‚Üê</button>
                <img id="mainImage" src="" alt="–≠–∫—Å–∫—É—Ä—Å–∏–æ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ">
                <div class="image-caption" id="imageCaption"></div>
                <button class="nav-btn prev-btn" onclick="prevSlide()">‚Äπ</button>
                <button class="nav-btn next-btn" onclick="nextSlide()">‚Ä∫</button>
            </div>

            <div class="dialogue-container">
                <div class="character-section">
                    <img class="character" id="characterImage" src="https://via.placeholder.com/150/0088cc/ffffff?text=–ì–∏–¥" alt="–ü–µ—Ä—Å–æ–Ω–∞–∂">
                    <div class="character-name" id="characterName">–ì–∏–¥-—ç–∫—Å–∫—É—Ä—Å–æ–≤–æ–¥</div>
                </div>

                <div class="text-section">
                    <div class="text-content" id="dialogueText"></div>
                    <div class="controls">
                        <button id="playBtn" onclick="toggleSpeech()">‚ñ∂ –û–∑–≤—É—á–∏—Ç—å</button>
                        <button onclick="pauseSpeech()">‚è∏ –ü–∞—É–∑–∞</button>
                        <button onclick="nextSlide()">–î–∞–ª–µ–µ ‚Üí</button>
                    </div>
                    <div class="progress-container">
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                        <span class="progress-text" id="progressText">1/3</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="loading" id="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</div>

    <script>
        // üìä –ë–ê–ó–ê –î–ê–ù–ù–´–• –í–°–ï–• –≠–ö–°–ö–£–†–°–ò–ô
        const toursDatabase = {
            'history': {
                title: "–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π —Ü–µ–Ω—Ç—Ä",
                character: {
                    name: "–ò—Å—Ç–æ—Ä–∏–∫ –ê–ª–µ–∫—Å–µ–π",
                    image: "https://via.placeholder.com/150/0088cc/ffffff?text=–ê–ª–µ–∫—Å–µ–π"
                },
                slides: [
                    {
                        image: "https://via.placeholder.com/800x400/ff6b6b/ffffff?text=–ì–ª–∞–≤–Ω–∞—è+–ø–ª–æ—â–∞–¥—å",
                        caption: "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –ø–ª–æ—â–∞–¥—å",
                        text: "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π —Ü–µ–Ω—Ç—Ä! –≠—Ç–∞ –ø–ª–æ—â–∞–¥—å –±—ã–ª–∞ –∑–∞–ª–æ–∂–µ–Ω–∞ –≤ 18 –≤–µ–∫–µ –∏ —Å–ª—É–∂–∏–ª–∞ –≥–ª–∞–≤–Ω—ã–º —Ç–æ—Ä–≥–æ–≤—ã–º –º–µ—Å—Ç–æ–º –≥–æ—Ä–æ–¥–∞."
                    },
                    {
                        image: "https://via.placeholder.com/800x400/4ecdc4/ffffff?text=–°—Ç–∞—Ä–∏–Ω–Ω—ã–π+—Å–æ–±–æ—Ä", 
                        caption: "–ö–∞—Ñ–µ–¥—Ä–∞–ª—å–Ω—ã–π —Å–æ–±–æ—Ä",
                        text: "–ü–µ—Ä–µ–¥ –≤–∞–º–∏ –≤–µ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–æ–±–æ—Ä, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –≤ 1754 –≥–æ–¥—É. –ï–≥–æ –≤—ã—Å–æ—Ç–∞ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 65 –º–µ—Ç—Ä–æ–≤ - —ç—Ç–æ —Å–∞–º–æ–µ –≤—ã—Å–æ–∫–æ–µ –∑–¥–∞–Ω–∏–µ —Å—Ç–∞—Ä–æ–≥–æ –≥–æ—Ä–æ–¥–∞."
                    },
                    {
                        image: "https://via.placeholder.com/800x400/45b7d1/ffffff?text=–ì–æ—Ä–æ–¥—Å–∫–∞—è+—Ä–∞—Ç—É—à–∞",
                        caption: "–ó–¥–∞–Ω–∏–µ —Ä–∞—Ç—É—à–∏",
                        text: "–ê —ç—Ç–æ –≥–æ—Ä–æ–¥—Å–∫–∞—è —Ä–∞—Ç—É—à–∞, –≥–¥–µ –Ω–∞ –ø—Ä–æ—Ç—è–∂–µ–Ω–∏–∏ –≤–µ–∫–æ–≤ –ø—Ä–∏–Ω–∏–º–∞–ª–∏—Å—å –≤–∞–∂–Ω–µ–π—à–∏–µ —Ä–µ—à–µ–Ω–∏—è, –æ–ø—Ä–µ–¥–µ–ª—è–≤—à–∏–µ —Å—É–¥—å–±—É –Ω–∞—à–µ–≥–æ –≥–æ—Ä–æ–¥–∞."
                    }
                ]
            },
            'architecture': {
                title: "–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —à–µ–¥–µ–≤—Ä—ã",
                character: {
                    name: "–ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä –ú–∞—Ä–∏—è",
                    image: "https://via.placeholder.com/150/ff6b6b/ffffff?text=–ú–∞—Ä–∏—è"
                },
                slides: [
                    {
                        image: "https://via.placeholder.com/800x400/96CEB4/ffffff?text=–ë–∞—Ä–æ–∫–∫–æ",
                        caption: "–°—Ç–∏–ª—å –±–∞—Ä–æ–∫–∫–æ",
                        text: "–≠—Ç–æ –∑–¥–∞–Ω–∏–µ - –ø—Ä–µ–∫—Ä–∞—Å–Ω—ã–π –ø—Ä–∏–º–µ—Ä –±–∞—Ä–æ–∫–∫–æ —Å –µ–≥–æ –ø—ã—à–Ω—ã–º–∏ —Ñ–æ—Ä–º–∞–º–∏ –∏ –±–æ–≥–∞—Ç—ã–º –¥–µ–∫–æ—Ä–æ–º. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –∏–∑–æ–≥–Ω—É—Ç—ã–µ –ª–∏–Ω–∏–∏!"
                    },
                    {
                        image: "https://via.placeholder.com/800x400/FFEAA7/333333?text=–ö–ª–∞—Å—Å–∏—Ü–∏–∑–º", 
                        caption: "–≠–ø–æ—Ö–∞ –∫–ª–∞—Å—Å–∏—Ü–∏–∑–º–∞",
                        text: "–ü–µ—Ä–µ–¥ –≤–∞–º–∏ –∑–¥–∞–Ω–∏–µ –≤ —Å—Ç–∏–ª–µ –∫–ª–∞—Å—Å–∏—Ü–∏–∑–º–∞ - —Å—Ç—Ä–æ–≥–∏–µ –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏, —Å–∏–º–º–µ—Ç—Ä–∏—è –∏ —Å–¥–µ—Ä–∂–∞–Ω–Ω–æ—Å—Ç—å —Ñ–æ—Ä–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É—é—Ç —ç—Ç—É —ç–ø–æ—Ö—É."
                    }
                ]
            },
            'museums': {
                title: "–ú—É–∑–µ–∏ –≥–æ—Ä–æ–¥–∞",
                character: {
                    name: "–ò—Å–∫—É—Å—Å—Ç–≤–æ–≤–µ–¥ –ê–Ω–Ω–∞",
                    image: "https://via.placeholder.com/150/96CEB4/ffffff?text=–ê–Ω–Ω–∞"
                },
                slides: [
                    {
                        image: "https://via.placeholder.com/800x400/DDA0DD/ffffff?text=–•—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π",
                        caption: "–•—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –º—É–∑–µ–π",
                        text: "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –Ω–∞—à —Ö—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –º—É–∑–µ–π! –ó–¥–µ—Å—å —Å–æ–±—Ä–∞–Ω–∞ —É–Ω–∏–∫–∞–ª—å–Ω–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è –∫–∞—Ä—Ç–∏–Ω —Ä—É—Å—Å–∫–∏—Ö –∏ –µ–≤—Ä–æ–ø–µ–π—Å–∫–∏—Ö –º–∞—Å—Ç–µ—Ä–æ–≤."
                    }
                ]
            },
            'parks': {
                title: "–ü–∞—Ä–∫–∏ –∏ —Å–∞–¥—ã",
                character: {
                    name: "–°–∞–¥–æ–≤–Ω–∏–∫ –ü–µ—Ç—Ä",
                    image: "https://via.placeholder.com/150/4ECDC4/ffffff?text=–ü–µ—Ç—Ä"
                },
                slides: [
                    {
                        image: "https://via.placeholder.com/800x400/96CEB4/ffffff?text=–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π+–ø–∞—Ä–∫",
                        caption: "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –ø–∞—Ä–∫",
                        text: "–≠—Ç–æ—Ç –ø–∞—Ä–∫ –±—ã–ª —Ä–∞–∑–±–∏—Ç –≤ 19 –≤–µ–∫–µ –∏ –¥–æ —Å–∏—Ö –ø–æ—Ä –æ—Å—Ç–∞–µ—Ç—Å—è –ª—é–±–∏–º—ã–º –º–µ—Å—Ç–æ–º –æ—Ç–¥—ã—Ö–∞ –≥–æ—Ä–æ–∂–∞–Ω. –ó–¥–µ—Å—å –ø—Ä–æ–∏–∑—Ä–∞—Å—Ç–∞–µ—Ç –±–æ–ª–µ–µ 100 –≤–∏–¥–æ–≤ —Ä–∞—Å—Ç–µ–Ω–∏–π."
                    }
                ]
            },
            'modern': {
                title: "–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞",
                character: {
                    name: "–î–∏–∑–∞–π–Ω–µ—Ä –°–µ—Ä–≥–µ–π",
                    image: "https://via.placeholder.com/150/45B7D1/ffffff?text=–°–µ—Ä–≥–µ–π"
                },
                slides: [
                    {
                        image: "https://via.placeholder.com/800x400/667eea/ffffff?text=–ù–µ–±–æ—Å–∫—Ä–µ–±",
                        caption: "–î–µ–ª–æ–≤–æ–π —Ü–µ–Ω—Ç—Ä",
                        text: "–≠—Ç–æ—Ç –Ω–µ–±–æ—Å–∫—Ä–µ–± –±—ã–ª –ø–æ—Å—Ç—Ä–æ–µ–Ω –≤ 2018 –≥–æ–¥—É –∏ —Å—Ç–∞–ª —Å–∏–º–≤–æ–ª–æ–º —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è –Ω–∞—à–µ–≥–æ –≥–æ—Ä–æ–¥–∞. –ï–≥–æ –≤—ã—Å–æ—Ç–∞ - 150 –º–µ—Ç—Ä–æ–≤!"
                    }
                ]
            },
            'secret': {
                title: "–°–µ–∫—Ä–µ—Ç–Ω—ã–µ –º–µ—Å—Ç–∞",
                character: {
                    name: "–ö—Ä–∞–µ–≤–µ–¥ –ò—Ä–∏–Ω–∞",
                    image: "https://via.placeholder.com/150/DDA0DD/ffffff?text=–ò—Ä–∏–Ω–∞"
                },
                slides: [
                    {
                        image: "https://via.placeholder.com/800x400/764ba2/ffffff?text=–¢–∞–π–Ω—ã–π+–¥–≤–æ—Ä",
                        caption: "–°–∫—Ä—ã—Ç—ã–π –¥–≤–æ—Ä–∏–∫",
                        text: "–≠—Ç–æ –º–µ—Å—Ç–æ –∑–Ω–∞—é—Ç —Ç–æ–ª—å–∫–æ –º–µ—Å—Ç–Ω—ã–µ –∂–∏—Ç–µ–ª–∏! –ó–¥–µ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏–ª–∞—Å—å —É–Ω–∏–∫–∞–ª—å–Ω–∞—è –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞ —Å—Ç–∞—Ä–æ–≥–æ –≥–æ—Ä–æ–¥–∞, –Ω–µ —Ç—Ä–æ–Ω—É—Ç–æ–≥–æ –≤—Ä–µ–º–µ–Ω–µ–º."
                    }
                ]
            }
        };

        // üéÆ –ü–ï–†–ï–ú–ï–ù–ù–´–ï –î–õ–Ø –£–ü–†–ê–í–õ–ï–ù–ò–Ø
        let currentTour = null;
        let currentSlide = 0;
        let isPlaying = false;
        let speech = null;

        // üè† –§–£–ù–ö–¶–ò–ò –ì–õ–ê–í–ù–û–ô –°–¢–†–ê–ù–ò–¶–´
        function openTour(tourId) {
            console.log('–û—Ç–∫—Ä—ã–≤–∞–µ–º —ç–∫—Å–∫—É—Ä—Å–∏—é:', tourId);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
            document.getElementById('loading').classList.add('show');
            
            setTimeout(() => {
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —ç–∫—Å–∫—É—Ä—Å–∏—é
                currentTour = tourId;
                
                // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—ã
                document.getElementById('homePage').style.display = 'none';
                document.getElementById('tourPage').style.display = 'block';
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º —ç–∫—Å–∫—É—Ä—Å–∏—é
                loadTour(tourId);
                
                // –°–∫—Ä—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
                document.getElementById('loading').classList.remove('show');
            }, 500);
        }

        function goBackToHome() {
            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ
            stopSpeech();
            
            // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            document.getElementById('tourPage').style.display = 'none';
            document.getElementById('homePage').style.display = 'block';
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
            currentTour = null;
            currentSlide = 0;
        }

        // üéØ –§–£–ù–ö–¶–ò–ò –≠–ö–°–ö–£–†–°–ò–ò
        function loadTour(tourId) {
            const tour = toursDatabase[tourId];
            if (!tour) {
                alert('–≠–∫—Å–∫—É—Ä—Å–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!');
                goBackToHome();
                return;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            document.title = tour.title;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
            document.getElementById('characterName').textContent = tour.character.name;
            document.getElementById('characterImage').src = tour.character.image;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–π —Å–ª–∞–π–¥
            showSlide(0);
        }

        function showSlide(index) {
            const tour = toursDatabase[currentTour];
            if (!tour || index < 0 || index >= tour.slides.length) return;
            
            currentSlide = index;
            const slide = tour.slides[index];
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
            document.getElementById('mainImage').src = slide.image;
            document.getElementById('imageCaption').textContent = slide.caption;
            document.getElementById('dialogueText').textContent = slide.text;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
            updateProgress();
            
            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ
            stopSpeech();
        }

        function updateProgress() {
            const tour = toursDatabase[currentTour];
            const progress = ((currentSlide + 1) / tour.slides.length) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('progressText').textContent = 
                (currentSlide + 1) + '/' + tour.slides.length;
        }

        // üé§ –°–ò–°–¢–ï–ú–ê –û–ó–í–£–ß–ö–ò
        function toggleSpeech() {
            if (isPlaying) {
                pauseSpeech();
            } else {
                playSpeech();
            }
        }

        function playSpeech() {
            if (isPlaying) return;
            
            const tour = toursDatabase[currentTour];
            const text = tour.slides[currentSlide].text;
            
            if (!window.speechSynthesis) {
                alert('–û–∑–≤—É—á–∫–∞ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤–∞—à–∏–º –±—Ä–∞—É–∑–µ—Ä–æ–º');
                return;
            }
            
            speech = new SpeechSynthesisUtterance(text);
            speech.lang = 'ru-RU';
            speech.rate = 0.9;
            
            speech.onstart = function() {
                isPlaying = true;
                document.getElementById('playBtn').textContent = '‚è∏ –ü–∞—É–∑–∞';
            };
            
            speech.onend = function() {
                isPlaying = false;
                document.getElementById('playBtn').textContent = '‚ñ∂ –û–∑–≤—É—á–∏—Ç—å';
            };
            
            speech.onerror = function() {
                isPlaying = false;
                document.getElementById('playBtn').textContent = '‚ñ∂ –û–∑–≤—É—á–∏—Ç—å';
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–∑–≤—É—á–∫–µ');
            };
            
            window.speechSynthesis.speak(speech);
        }

        function pauseSpeech() {
            if (window.speechSynthesis && isPlaying) {
                window.speechSynthesis.pause();
                isPlaying = false;
                document.getElementById('playBtn').textContent = '‚ñ∂ –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å';
            }
        }

        function stopSpeech() {
            if (window.speechSynthesis) {
                window.speechSynthesis.cancel();
                isPlaying = false;
                document.getElementById('playBtn').textContent = '‚ñ∂ –û–∑–≤—É—á–∏—Ç—å';
            }
        }

        // ‚óÄÔ∏è ‚ñ∂Ô∏è –ù–ê–í–ò–ì–ê–¶–ò–Ø
        function nextSlide() {
            const tour = toursDatabase[currentTour];
            if (currentSlide < tour.slides.length - 1) {
                showSlide(currentSlide + 1);
            } else {
                alert('–≠–∫—Å–∫—É—Ä—Å–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é.');
                goBackToHome();
            }
        }

        function prevSlide() {
            if (currentSlide > 0) {
                showSlide(currentSlide - 1);
            }
        }

        // üöÄ –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø
        document.addEventListener('DOMContentLoaded', function() {
            console.log('–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ!');
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Telegram Web App –µ—Å–ª–∏ –æ–Ω –¥–æ—Å—Ç—É–ø–µ–Ω
            if (window.Telegram && window.Telegram.WebApp) {
                window.Telegram.WebApp.ready();
                window.Telegram.WebApp.expand();
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
            document.getElementById('homePage').style.display = 'block';
            document.getElementById('tourPage').style.display = 'none';
        });

        // üõü –û–ë–†–ê–ë–û–¢–ö–ê –û–®–ò–ë–û–ö
        window.addEventListener('error', function() {
            document.getElementById('loading').classList.remove('show');
        });
    </script>
</body>
</html>
